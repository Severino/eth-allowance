(this["webpackJsonpeth-allowance"]=this["webpackJsonpeth-allowance"]||[]).push([[0],{102:function(t,e){t.exports={ERC20ABI:[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}],ERC721ABI:[{constant:!0,inputs:[],name:"name",outputs:[{name:"_name",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_tokenId",type:"uint256"}],name:"getApproved",outputs:[{name:"_approved",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"approve",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"implementsERC721",outputs:[{name:"_implementsERC721",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"_totalSupply",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transferFrom",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{name:"_tokenId",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_tokenId",type:"uint256"}],name:"ownerOf",outputs:[{name:"_owner",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_tokenId",type:"uint256"}],name:"tokenMetadata",outputs:[{name:"_infoUrl",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"_balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_owner",type:"address"},{name:"_tokenId",type:"uint256"},{name:"_approvedAddress",type:"address"},{name:"_metadata",type:"string"}],name:"mint",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"_symbol",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_tokenId",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"numTokensTotal",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"getOwnerTokens",outputs:[{name:"_tokenIds",type:"uint256[]"}],payable:!1,stateMutability:"view",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"_to",type:"address"},{indexed:!0,name:"_tokenId",type:"uint256"}],name:"Mint",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_owner",type:"address"},{indexed:!0,name:"_approved",type:"address"},{indexed:!1,name:"_tokenId",type:"uint256"}],name:"Approval",type:"event"}]}},103:function(t,e){t.exports={compound:"https://app.compound.finance/#",aave:"https://aave.com/",uniswap:"https://uniswap.org/",nest:"https://nestdapp.io/",cofi:"https://cofix.io/"}},104:function(t,e,n){},215:function(t,e){},223:function(t,e){},239:function(t,e){},241:function(t,e){},265:function(t,e){},284:function(t,e){},286:function(t,e){},318:function(t,e){},323:function(t,e){},325:function(t,e){},332:function(t,e){},351:function(t,e){},383:function(t,e){},491:function(t,e,n){},492:function(t,e,n){},493:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return i}));var a=n(10),s=n(12),r=n(13),o=n(5),c=n.n(o),i=function(){function t(){Object(s.a)(this,t)}return Object(r.a)(t,null,[{key:"available",value:function(){throw new Error("Call of abstract method 'available' on wallet: "+this.name)}},{key:"connect",value:function(){var t=Object(a.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Call of abstract method 'connect' on wallet: "+this.name);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"on",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"off",value:function(t,e){var n,a=null===(n=this.listeners[t])||void 0===n?void 0:n.indexOf(e);if(-1===a)return!1;this.listeners[t].splice(a,1)}},{key:"accountChanged",value:function(){throw new Error("Call of abstract method 'accountChanged' on wallet: "+this.name)}},{key:"networkChanged",value:function(){throw new Error("Call of abstract method 'networkChanged' on wallet: "+this.name)}},{key:"getChainId",value:function(){var t=Object(a.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Call of abstract method 'getNetwork' on wallet: "+this.name);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}()},495:function(t,e,n){"use strict";n.r(e);var a=n(1),s=n.n(a),r=n(67),o=n.n(r),c=(n(104),n(54)),i=n(68),u=n.n(i),l=n(12),p=n(13),d=n(17),h=n(16),b=n(21),f=n.n(b),m=n(22),j=n(0),y=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"experimental-warning",children:[Object(j.jsx)(f.a,{path:m.f,size:"16",color:"white"}),"Experimental"]}),Object(j.jsx)("div",{className:"jumbotron",children:Object(j.jsxs)("div",{id:"titles",children:[Object(j.jsx)("img",{src:"harmony-lock-logo.png",alt:"Harmony Lock Logo"}),Object(j.jsx)("h1",{children:"Harmony Allowance"}),Object(j.jsx)("h2",{children:"Find & revoke all the addresses that can spend your HRC20 tokens"}),Object(j.jsx)("p",{children:"The app looks up your transaction history for approval transactions. If it finds some it shows them in the table. When the transaction has an input of 0 (which means you revoked the allowance) then the transaction will be excluded from the list. You can now show those transactions by clicking the 'Show Zero Allowance' button."}),Object(j.jsxs)("p",{children:["You can verify that the allowance is set to zero, by clicking in the allowance row with the",Object(j.jsx)(f.a,{path:m.g,size:"16",color:"rgb(0, 174, 233)"})," Symbol. It may occur, that the allowance shows 'some' before you click it and 0 after. This happens if set a specific spending limit and then you spent it all. The app won't notice that, as it just looks at the input."]}),Object(j.jsx)("p",{children:"To cut the RPC some slack, a 'Load More' button was introduced, that lets you load your transactions in little bits."}),Object(j.jsxs)("p",{children:["Please report bugs and feature requests here:",Object(j.jsx)("br",{})," ",Object(j.jsx)("a",{href:"https://github.com/Severino/harmony-allowance/issues",children:"https://github.com/Severino/harmony-allowance/issues"})]})]})})]})}}]),n}(a.Component),v=y,w=n(201),x=n(10),O=n(9),k=n(5),g=n.n(k),C=n(200),M=n(20);function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.length,a=void 0===n?3:n;return t?t.substring(0,a+2)+"..."+t.substring(t.length-a):""}var N=n(68),S=new N(N.givenProvider),T=S.utils.BN,A=n(449),I="0x095ea7b3",R=n(102),E=R.ERC20ABI,B=R.ERC721ABI,F=n(456),U=F.toBech32,D=F.fromBech32,L="ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",W="0000000000000000000000000000000000000000000000000000000000000000";function q(t){switch(parseInt(t,10)){case 16666e5:return"https://harmony-0-rpc.gateway.pokt.network";case 16667e5:return"https://api.s0.pops.one";default:return null}}function z(t,e,n){return H.apply(this,arguments)}function H(){return(H=Object(x.a)(g.a.mark((function t(e,n,a){var s,r,o,c,i,u;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=a.page,r=void 0===s?0:s,o=a.num,c=void 0===o?25:o,t.prev=1,i=U(n),t.next=5,A.post(e).set("Content-Type","application/json").accept("application/json").send({jsonrpc:"2.0",method:"hmyv2_getTransactionsHistory",params:[{address:i,pageIndex:r,pageSize:c,fullTx:!0,txType:"ALL",order:"DESC"}],id:1});case 5:return u=t.sent,t.abrupt("return",u.body.result.transactions);case 9:throw t.prev=9,t.t0=t.catch(1),t.t0;case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))).apply(this,arguments)}function Z(t){return P.apply(this,arguments)}function P(){return(P=Object(x.a)(g.a.mark((function t(e){var n,a,s,r,o,c,i,u,l,p,d;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={},(null===e||void 0===e?void 0:e.length)>0){a=Object(C.a)(e.values());try{for(a.s();!(s=a.n()).done;)(r=s.value).input.includes(I)&&(o=r.hash,c=S.utils.toChecksumAddress(D(r.to)),i=S.utils.toChecksumAddress("0x"+r.input.substring(34,74)),u=r.timestamp,l=r.input.substring(74),p=l.includes(L)?"unlimited":l.includes(W)?"none":"some",d={hash:o,timestamp:u,contract:i,token:c,allowance:l,allowanceString:p},n[i]=n[i]||{},n[i][c]||(n[i][c]=[]),n[i][c].push(d))}catch(h){a.e(h)}finally{a.f()}}return t.abrupt("return",n);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function J(t){return new S.eth.Contract(E,t)}function V(t){return Y.apply(this,arguments)}function Y(){return(Y=Object(x.a)(g.a.mark((function t(e){var n,a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=_(e,{length:4}),t.prev=1,a=J(e),t.next=5,a.methods.name().call();case 5:n=t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.error(t.t0);case 11:return t.abrupt("return",n);case 12:case"end":return t.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function K(t,e,n){return G.apply(this,arguments)}function G(){return(G=Object(x.a)(g.a.mark((function t(e,n,a){var s,r,o,c,i,u,l,p,d;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=void 0,t.prev=1,r=J(n),t.next=5,r.methods.allowance(e,a).call();case 5:return o=t.sent,t.next=8,r.methods.decimals().call();case 8:c=t.sent,u=c-(i=c-6>0?6:c),l=new T(o).div(new T(10).pow(new T(u))),p=1e9*Math.pow(10,i),console.log(o,l,new T(p)),s="0"===o?"0":l.gt(new T(p))?"> 1 Billion":l.eq(new T(0))?"< 0.".concat("0".repeat(i)):l.toNumber()/Math.pow(10,i).toFixed(i),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(1),d="Could not get allowance!",M.b.error(d),console.error(d,t.t0);case 22:return t.abrupt("return",s);case 23:case"end":return t.stop()}}),t,null,[[1,17]])})))).apply(this,arguments)}function Q(){return(Q=Object(x.a)(g.a.mark((function t(e,n){var a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new S.eth.Contract(B,e),t.prev=1,t.next=4,a.methods.ownerOf(n).call();case 4:return t.abrupt("return",!0);case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}var X=n(103),$=n.n(X),tt=n(102);function et(t){switch(parseInt(t,16)){case 16667e5:return"https://explorer.pops.one";case 16666e5:return"https://explorer.harmony.one";default:return console.warn("Could not find explorer for chain ",t),"https://explorer.harmony.one"}}function nt(t){return et(window.ethereum.chainId)+"/address/"+t}var at=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).props=t,a.state={allowance:null},a.setRevokeClick=a.setRevokeClick.bind(Object(O.a)(a)),a.dappURL=a.dappURL.bind(Object(O.a)(a)),a.initRevoke=a.initRevoke.bind(Object(O.a)(a)),a.revokeSuccess=a.revokeSuccess.bind(Object(O.a)(a)),a.revokeFailed=a.revokeFailed.bind(Object(O.a)(a)),a.getAllowance=a.getAllowance.bind(Object(O.a)(a)),a.requestAllowance=a.requestAllowance.bind(Object(O.a)(a)),a}return Object(p.a)(n,[{key:"dappURL",value:function(){for(var t="",e=0,n=Object.keys($.a);e<n.length;e++){var a=n[e];this.props.tx.contractName.toLowerCase().includes(a)&&(t=$.a[a])}return t}},{key:"setRevokeClick",value:function(){var t=this,e=new this.props.web3.eth.Contract(tt.ERC20ABI,this.props.tx.token);(function(t,e){return Q.apply(this,arguments)})(e,this.props.tx.allowanceUnEdited).then((function(n){if(n)throw new Error("ERC 721 is not supported yet!");t.initRevoke(),e.methods.approve(t.props.tx.contract,0).send({from:t.props.account}).then(t.revokeSuccess).catch(t.revokeFailed)}))}},{key:"initRevoke",value:function(){this.props.onStatusChange("pending",this.props.tx)}},{key:"revokeSuccess",value:function(t){M.b.success("Successfully Revoked!"),this.props.onStatusChange("success",this.props.tx)}},{key:"revokeFailed",value:function(t){M.b.error("Could Not Revoke Allowance!"),console.error(t),this.props.onStatusChange("none",this.props.tx)}},{key:"renderRevokeButton",value:function(){return"pending"===this.props.status?Object(j.jsx)("button",{className:"icon-btn",children:Object(j.jsx)(f.a,{path:m.b,size:1,color:"#dbdbdb"})}):"success"===this.props.status?Object(j.jsx)("button",{className:"icon-btn",children:Object(j.jsx)(f.a,{path:m.c,size:1,color:"#78e900"})}):Object(j.jsx)("button",{className:"icon-btn",name:"revoke",onClick:this.setRevokeClick,children:"none"===this.props.tx.allowanceString?Object(j.jsx)(f.a,{path:m.c,size:1,color:"#78e900"}):Object(j.jsx)(f.a,{path:m.a,size:1,color:"#e90000"})})}},{key:"getAllowance",value:function(){return this.state.allowance?this.state.allowance:this.props.tx.allowanceString}},{key:"requestAllowance",value:function(){var t=Object(x.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K(this.props.account,this.props.tx.token,this.props.tx.contract);case 2:e=t.sent,this.setState({allowance:e});case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return Object(j.jsxs)("tr",{className:this.props.tx.allowanceString,children:[Object(j.jsx)("td",{className:"grid-items",children:new Date(1e3*parseInt(this.props.tx.timestamp)).toLocaleString()}),Object(j.jsx)("td",{className:"grid-items",children:Object(j.jsx)("a",{href:nt(this.props.tx.token),target:"_blank",rel:"noreferrer",children:this.props.tx.tokenName||_(this.props.tx.token)})}),Object(j.jsx)("td",{className:"grid-items",children:Object(j.jsx)("a",{href:nt(this.props.tx.contract),target:"_blank",rel:"noreferrer",children:_(this.props.tx.contract)})}),Object(j.jsx)("td",{children:Object(j.jsx)("a",{href:(t=this.props.tx.hash,et(window.ethereum.chainId)+"/tx/"+t),target:"_blank",rel:"noreferrer",children:_(this.props.tx.hash)})}),Object(j.jsx)("td",{className:"grid-items",children:Object(j.jsxs)("button",{className:"sync-btn icon-btn",onClick:this.requestAllowance,children:[Object(j.jsx)("span",{children:this.getAllowance()}),Object(j.jsx)(f.a,{path:m.g,size:.8})]})}),Object(j.jsx)("td",{className:"grid-items",children:this.renderRevokeButton()})]},"allowance-nr-"+this.props.tx.hash);var t}}]),n}(a.Component),st=at,rt=(n(491),function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(p.a)(n,[{key:"renderText",value:function(){return null==this.props.total?Object(j.jsx)("div",{children:"Fetching Items ..."}):Object(j.jsxs)("div",{children:["Loading items ",this.props.current,"/",this.props.total]})}},{key:"render",value:function(){return Object(j.jsxs)("div",{className:"spinner",children:[Object(j.jsxs)("div",{className:"lds-grid",children:[Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{}),Object(j.jsx)("div",{})]}),this.renderText()]})}}]),n}(a.Component)),ot=rt,ct=n(15),it=(n(492),function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={value:10,tipped:!1},a.updateValue=a.updateValue.bind(Object(O.a)(a)),a.sendTip=a.sendTip.bind(Object(O.a)(a)),a}return Object(p.a)(n,[{key:"render",value:function(){return this.props.account?Object(j.jsxs)("div",{className:"tip",children:[!this.state.tipped&&Object(j.jsxs)("div",{children:[Object(j.jsxs)("p",{children:["Thank you for using ",Object(j.jsx)("i",{children:"Harmony Allowance"})]}),Object(j.jsx)("p",{children:"If it was useful for you, please consider giving a small tip to the developer. This will help to keep this and future projects running!"}),Object(j.jsxs)("div",{className:"input",children:[Object(j.jsx)("input",{type:"number",value:this.state.value,onInput:this.updateValue}),Object(j.jsx)("button",{id:"tip-button",onClick:this.sendTip,children:"Tip"})]})]}),this.state.tipped&&Object(j.jsx)("p",{children:"THANK YOU FOR YOUR SUPPORT!!!"})]}):Object(j.jsx)("div",{})}},{key:"updateValue",value:function(t){this.setState({value:t.target.value})}},{key:"sendTip",value:function(){var t=this;window.ethereum.request({method:"eth_sendTransaction",params:[{from:this.props.account,to:this.props.address,value:Object(ct.toHex)(Object(ct.toWei)(this.state.value.toString()))}]}).then((function(){t.setState({tipped:!0})})).catch(console.error)}}]),n}(a.Component)),ut=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(p.a)(n,null,[{key:"name",get:function(){return"metamask"}},{key:"getChainId",value:function(){var t=Object(x.a)(g.a.mark((function t(){var e;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,window.ethereum.chainId;case 2:return e=t.sent,t.abrupt("return",parseInt(e,16));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"available",value:function(){return window.ethereum&&window.ethereum.isMetaMask}},{key:"connect",value:function(){var t=Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.requestAccounts());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"requestAccounts",value:function(){return new Promise((function(t,e){window.ethereum?window.ethereum.request({method:"eth_requestAccounts"}).then((function(e){return t(e[0])})).catch((function(t){4001===t.code?e("Please connect to MetaMask."):e(t)})):e("Metamask not found!")}))}}]),n}(n(493).default),lt={};lt[ut.name]=ut;var pt=lt,dt=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).connectMetaMask=a.connectMetaMask.bind(Object(O.a)(a)),a.connectOneWallet=a.connectOneWallet.bind(Object(O.a)(a)),a}return Object(p.a)(n,[{key:"render",value:function(){function t(t){return t.account?function(t){return Object(j.jsxs)("div",{className:"account",children:[Object(j.jsx)("span",{children:t.account}),Object(j.jsx)("button",{onClick:t.disconnect,children:"Disconnect"})]})}(t):function(t){return Object(j.jsx)("button",{onClick:t.connect,children:"Connect MetaMask"})}(t)}return Object(j.jsx)("div",{className:"signin",children:Object(j.jsx)(t,{connect:this.connectMetaMask,account:_(this.props.account,{length:5})})})}},{key:"connectMetaMask",value:function(){this.connectWallet("metamask")}},{key:"connectOneWallet",value:function(){this.connectWallet("onewallet")}},{key:"connectWallet",value:function(){var t=Object(x.a)(g.a.mark((function t(e){var n,a,s,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=pt[e])){t.next=14;break}return t.next=4,n.connect();case 4:if(a=t.sent,s=null,!a){t.next=11;break}return t.next=9,n.getChainId();case 9:r=t.sent,s=r;case 11:this.props.update({account:a,network:s}),t.next=15;break;case 14:console.error('Wallet with name "'.concat(e,'" is not defined!'));case 15:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(a.Component),ht=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(l.a)(this,n),(a=e.call(this,t)).state={approvalMap:{},approveTransactions:[],account:void 0,fee:null,loading:!1,totalTransactionCount:null,currentTransactionCount:null,page:0,pageNum:100,moreTransactions:!0,showZeroAllowance:!1},a.props=t,a.walletUpdated=a.walletUpdated.bind(Object(O.a)(a)),a.statusChanged=a.statusChanged.bind(Object(O.a)(a)),a.loadMore=a.loadMore.bind(Object(O.a)(a)),a.disconnect=a.disconnect.bind(Object(O.a)(a)),a.init=a.init.bind(Object(O.a)(a)),a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.init().then((function(e){t.setState(e)})).catch((function(t){M.b.error("Could not load application."),console.error(t)}))}},{key:"init",value:function(){var t=Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.account&&this.state.network||null==window.ethereum||this.setState({account:window.ethereum.selectedAddress,network:parseInt(window.ethereum.chainId,16)}),this.state.account&&this.state.network){t.next=4;break}return t.abrupt("return",null);case 4:return t.prev=4,t.next=7,this.updateTransactions();case 7:t.next=13;break;case 9:t.prev=9,t.t0=t.catch(4),M.b.error("Could not fetch transactions - try reloading the page."),console.error(t.t0);case 13:case"end":return t.stop()}}),t,this,[[4,9]])})));return function(){return t.apply(this,arguments)}}()},{key:"updateTransactions",value:function(){var t=Object(x.a)(g.a.mark((function t(){var e,n,a,s,r,o,i,u,l,p,d,h,b,f,m,j,y,v,x,O,k,C,M,_,N;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.setState({loading:!0}),e=q(this.state.network)){t.next=4;break}throw new Error("Wrong network! Change network and reload.");case 4:return t.next=6,z(e,this.state.account,{page:this.state.page,num:this.state.pageNum});case 6:if(!((n=t.sent).length<this.state.pageNum)){t.next=10;break}return t.next=10,this.setState({moreTransactions:!1});case 10:return t.next=12,Z(n);case 12:for(a=t.sent,s=this.state.approvalMap,r=0,o=Object.entries(a);r<o.length;r++)for(i=Object(c.a)(o[r],2),u=i[0],l=i[1],s[u]||(s[u]={}),p=0,d=Object.entries(l);p<d.length;p++)b=Object(c.a)(d[p],2),f=b[0],m=b[1],s[u][f]||(s[u][f]=[]),(h=s[u][f]).push.apply(h,Object(w.a)(m));j=[],y=0,v=Object.values(s);case 17:if(!(y<v.length)){t.next=35;break}x=v[y],O=0,k=Object.values(x);case 20:if(!(O<k.length)){t.next=32;break}return C=k[O],M=C[0],_=C[0],j.push(_),t.next=27,V(_.token);case 27:for(_.tokenName=t.sent,N=1;N<C.length;N++)M.timestamp-C[N].timestamp<0&&console.error("CODE CONTAINS ERRORS: OLDER OBJECT WAS ADDED BEFORE!!!!");case 29:O++,t.next=20;break;case 32:y++,t.next=17;break;case 35:return j=j.sort((function(t,e){return e.timestamp-t.timestamp})),t.next=38,this.setState({loading:!1,approveTransactions:j,approvalMap:s});case 38:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setError",value:function(t){M.b.error("Something went wrong!"),console.error(t)}},{key:"statusChanged",value:function(t,e){var n=this.state.approveTransactions,a=n.findIndex((function(t){return t.hash===e.hash}));-1!==a&&(n[a].status=t,this.forceUpdate())}},{key:"loadMore",value:function(){var t=Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setState({page:this.state.page+1});case 2:try{this.updateTransactions()}catch(e){this.setState({page:this.state.page-1}),M.b.error("Some error occured on load: try again!"),console.error(e)}case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,e=this,n="";function a(t){var n=e.state.showZeroAllowance?"show-revoked":"hide-revoked";return Object(j.jsxs)("table",{className:n,children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("td",{className:"grid-items",children:"Time"}),Object(j.jsx)("td",{className:"grid-items",children:"Token"}),Object(j.jsx)("td",{className:"grid-items",children:"Approved Address"}),Object(j.jsx)("td",{className:"grid-items",children:"Tx.-Hash"}),Object(j.jsx)("td",{className:"grid-items",children:"Allowance"}),Object(j.jsx)("td",{className:"grid-items",children:"Revoke"})]})}),Object(j.jsx)("tbody",{children:t.elements})]})}function s(t){return Object(j.jsxs)("div",{children:[Object(j.jsx)(it,{account:t.account,address:"0x23F822FC0CA75622cF6C48A4fba508E068f0E15b"}),Object(j.jsxs)("div",{className:"options-btn interactive",onClick:function(){return e.setState({showZeroAllowance:!e.state.showZeroAllowance})},children:[e.state.showZeroAllowance?Object(j.jsx)(f.a,{path:m.e,size:.9}):Object(j.jsx)(f.a,{path:m.d,size:.9}),Object(j.jsx)("span",{children:e.state.showZeroAllowance?"Hide Zero Allowances":"Show Zero Allowances"})]}),Object(j.jsx)(a,{elements:n}),t.loading?Object(j.jsx)(ot,{}):0===t.transactions.length?Object(j.jsx)("div",{className:"info",children:"No Approval Transactions Found"}):e.state.moreTransactions?Object(j.jsx)("button",{className:"more-btn center",onClick:e.loadMore,children:"Load More ..."}):Object(j.jsx)("div",{className:"info",children:"End Of Transactions History"})]})}return this.state.approveTransactions.length>0&&(n=this.state.approveTransactions.map((function(e){return Object(j.jsx)(st,{tx:e,web3:t.props.web3,id:e.contract,account:t.state.account,status:e.status,onStatusChange:t.statusChanged},"allowance-"+e.hash)}))),Object(j.jsxs)("div",{className:"allowance",children:[Object(j.jsx)(dt,{account:this.state.account,network:this.state.network,disconnect:this.disconnect,update:this.walletUpdated}),this.state.account?Object(j.jsx)(s,{account:this.state.account,loading:this.state.loading,transactions:this.state.approveTransactions}):""]})}},{key:"disconnect",value:function(){this.setState({account:null})}},{key:"walletUpdated",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.account,n=t.network;this.setState({account:e,network:n})}},{key:"componentDidUpdate",value:function(t,e){e.account!==this.state.account&&this.init()}}]),n}(a.Component),bt=ht,ft=(n(494),new u.a(u.a.givenProvider)),mt="experimental-aggreement";function jt(t){window.localStorage.setItem(mt,JSON.stringify({timestamp:(new Date).getTime(),agreed:t}))}var yt=function(){var t=function(){var t={agreed:!1,timestamp:Date.now()};try{var e=window.localStorage.getItem(mt),n=JSON.parse(e);n.agreed&&n.timestamp&&(Date.now()-n.timestamp>2592e6&&(n.agreed=!1),t=jt)}catch(a){console.warn("Could not load stored agreement.")}return t.agreed}(),e=Object(a.useState)(t),n=Object(c.a)(e,2),s=n[0],r=n[1];return Object(j.jsxs)("div",{className:"content-wrapper",children:[Object(j.jsx)(M.a,{}),Object(j.jsxs)("main",{className:"content",children:[Object(j.jsx)(v,{}),Object(j.jsx)(bt,{web3:ft})]}),!1===s&&Object(j.jsx)("div",{className:"modal",children:Object(j.jsxs)("div",{className:"modal-content",children:[Object(j.jsx)("h3",{children:"Warning: Experimental Application"}),Object(j.jsxs)("p",{children:["This application is a fork, of an Ethereum based application and just ported for the Harmony blockchain. It is not thoroughly tested and you should ",Object(j.jsx)("b",{children:"use it on your own risk!"})]}),Object(j.jsx)("button",{onClick:function(){r(!0),jt(!0)},children:"Okay"})]})})]})};o.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(yt,{})}),document.getElementById("root"))}},[[495,1,2]]]);
//# sourceMappingURL=main.c49c7285.chunk.js.map